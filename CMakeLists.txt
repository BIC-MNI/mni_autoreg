# CMakeFiles.txt for the bicpl library
#
# Vladimir S. FONOV - vladimir.fonov@gmail.com

CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(N3)

#SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake-modules")
ENABLE_TESTING()
INCLUDE(CTest)

#ADD_SUBDIRECTORY( doc )

# Packaging defines
SET(CPACK_GENERATOR TGZ)
SET(CPACK_PACKAGE_VERSION_MAJOR 0)
SET(CPACK_PACKAGE_VERSION_MINOR 99)
SET(CPACK_PACKAGE_VERSION_PATCH 60)
INCLUDE(CPack)


SET(PACKAGE "mni_autoreg")
SET(PACKAGE_BUGREPORT "louis@bic.mni.mcgill.ca")

SET(PACKAGE_NAME "mni_autoreg")
SET(PACKAGE_VERSION "${CPACK_PACKAGE_VERSION_MAJOR}.${CPACK_PACKAGE_VERSION_MINOR}.${CPACK_PACKAGE_VERSION_PATCH}")
SET(PACKAGE_STRING "${PACKAGE_NAME} ${PACKAGE_VERSION}")

FIND_PACKAGE( MINC2 REQUIRED )
FIND_PACKAGE( Perl REQUIRED )
INCLUDE( ${MINC2_USE_FILE} )

ADD_DEFINITIONS(-DHAVE_CONFIG_H)

# add for building relocatable library
# IF(UNIX)
#   SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -fPIC")
#   SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC")
# ENDIF(UNIX)

# aliases
SET(VERSION "${PACKAGE_VERSION}")


# check for prereqs
#INCLUDE(CheckFunctionExists)
INCLUDE(CheckIncludeFiles)

#CHECK_FUNCTION_EXISTS(finite   HAVE_FINITE)
#CHECK_FUNCTION_EXISTS(isfinite HAVE_ISFINITE)

CHECK_INCLUDE_FILES(float.h     HAVE_FLOAT_H)
CHECK_INCLUDE_FILES(limits.h    HAVE_LIMITS_H)
CHECK_INCLUDE_FILES(sys/stat.h  HAVE_SYS_STAT_H)
CHECK_INCLUDE_FILES(sys/types.h HAVE_SYS_TYPES_H)
CHECK_INCLUDE_FILES(values.h    HAVE_VALUES_H)
CHECK_INCLUDE_FILES(unistd.h    HAVE_UNISTD_H)
CHECK_INCLUDE_FILES(memory.h    HAVE_MEMORY_H)
CHECK_INCLUDE_FILES(math.h      HAVE_MATH_H)
CHECK_INCLUDE_FILES(malloc.h    HAVE_MALLOC_H)
CHECK_INCLUDE_FILES(stdlib.h    HAVE_STDLIB_H)
CHECK_INCLUDE_FILES(inttypes.h  HAVE_INTTYPES_H)
CHECK_INCLUDE_FILES(string.h    HAVE_STRING_H)
CHECK_INCLUDE_FILES(strings.h   HAVE_STRINGS_H)

SET(MNI_AUTOREG_COMPILE_DATETIME "")
SET(MNI_AUTOREG_COMPILE_USER  "")
SET(MNI_AUTOREG_COMPILE_SYSTEM ${CMAKE_SYSTEM})
SET(MNI_AUTOREG_COMPILE_HOST "")
SET(MNI_AUTOREG_LONG_VERSION ${PACKAGE_STRING})

# others
CONFIGURE_FILE(${CMAKE_SOURCE_DIR}/config.h.cmake ${CMAKE_BINARY_DIR}/config.h)
CONFIGURE_FILE(${CMAKE_SOURCE_DIR}/epm-header.in ${CMAKE_BINARY_DIR}/epm-header)

INCLUDE_DIRECTORIES(  ${CMAKE_BINARY_DIR} Proglib )
LINK_LIBRARIES( ${VOLUME_IO_LIBRARIES} ${MINC2_LIBRARIES})

ADD_SUBDIRECTORY(Proglib)
ADD_SUBDIRECTORY(make_phantom)
ADD_SUBDIRECTORY(mincbbox)
ADD_SUBDIRECTORY(mincblur )
ADD_SUBDIRECTORY(mincchamfer )
ADD_SUBDIRECTORY(minctracc )
ADD_SUBDIRECTORY(perl )

# testing
IF(BUILD_TESTING)
	ADD_SUBDIRECTORY(Testing)
ENDIF(BUILD_TESTING)
